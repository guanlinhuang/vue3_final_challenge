"use strict";(self["webpackChunkvue3_final_challenge"]=self["webpackChunkvue3_final_challenge"]||[]).push([[499],{5499:function(e,t,l){l.r(t),l.d(t,{default:function(){return be}});var a=l(6768),s=l(4232),d=l(5130);const n={class:"container py-5 mx-auto"},i={class:"d-none d-lg-block"},r={class:"table mt-5"},o={class:"text-center align-middle"},c=["onClick"],u={class:"align-middle"},p={class:"align-middle"},k={class:"list-unstyled"},h={class:"text-center"},L={class:"form-check form-switch"},m=["for"],g={key:0,class:"text-success"},b={key:1,class:"text-danger"},v=["id","onUpdate:modelValue","onChange"],_={class:"align-middle"},f={class:"btn-group"},y=["onClick"],C={class:"d-lg-none"},x={class:"row mt-3"},O={class:"col-3"},$={class:"mb-0"},M={class:"col-7"},E={class:"mb-0"},X={class:"col-2 d-flex justify-content-end align-items-start"},w=["onClick"],P={class:"py-3 border-top border-bottom mt-3"},D={class:"list-unstyled mb-0"},F={class:"row mt-3 mb-3"},S={class:"col-5 d-flex align-items-center"},I={class:"mb-0 ms-3"},A={class:"col-7 d-flex justify-content-end align-items-center"},K=["onClick"],U={class:"form-check form-switch ps-0"},j=["for"],N={key:0,class:"text-success"},V={key:1,class:"text-danger"},q=["id","onUpdate:modelValue","onChange"];function H(e,t,l,H,T,B){const Q=(0,a.g2)("Loading"),z=(0,a.g2)("OrderModal"),G=(0,a.g2)("DelModal"),J=(0,a.g2)("Pagination");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(Q,{active:T.isLoading},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.Lk)("section",null,[(0,a.Lk)("span",{class:"loader-18"})],-1)]))),_:1},8,["active"]),(0,a.Lk)("div",n,[t[10]||(t[10]=(0,a.Lk)("h3",{class:"text-center"},"訂單列表",-1)),(0,a.Lk)("div",i,[(0,a.Lk)("table",r,[t[3]||(t[3]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th"),(0,a.Lk)("th",null,"建立日期"),(0,a.Lk)("th",null,"訂單編號"),(0,a.Lk)("th",null,"商品明細"),(0,a.Lk)("th",{class:"text-center"},"金額"),(0,a.Lk)("th",{class:"text-center"},"付款狀態"),(0,a.Lk)("th")])],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(T.orders,((l,n)=>((0,a.uX)(),(0,a.CE)("tbody",{key:n},[(0,a.Lk)("tr",null,[(0,a.Lk)("td",o,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>B.openDelOrderModal(l)},t[1]||(t[1]=[(0,a.Lk)("i",{class:"bi bi-x-lg"},null,-1)]),8,c)]),(0,a.Lk)("td",u,(0,s.v_)(e.$filters.date(l.create_at)),1),(0,a.Lk)("td",p,(0,s.v_)(l.id),1),(0,a.Lk)("td",null,[(0,a.Lk)("ul",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.products,((e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:t},(0,s.v_)(e.product.title)+" - "+(0,s.v_)(e.qty)+" "+(0,s.v_)(e.product.unit),1)))),128))])]),(0,a.Lk)("td",h," $"+(0,s.v_)(e.$filters.currency(Math.round(l.total))),1),(0,a.Lk)("td",null,[(0,a.Lk)("div",L,[(0,a.Lk)("label",{class:"form-check-label",for:`paidSwitch${l.id}`},[l.is_paid?((0,a.uX)(),(0,a.CE)("span",g,"付款完成")):((0,a.uX)(),(0,a.CE)("span",b,"尚未付款"))],8,m),t[2]||(t[2]=(0,a.Lk)("br",null,null,-1)),(0,a.bo)((0,a.Lk)("input",{class:"form-check-input mx-auto",type:"checkbox",id:`paidSwitch${l.id}`,"onUpdate:modelValue":e=>l.is_paid=e,onChange:e=>B.updatePaid(l)},null,40,v),[[d.lH,l.is_paid]])])]),(0,a.Lk)("td",_,[(0,a.Lk)("div",f,[(0,a.Lk)("button",{class:"btn btn-outline-success btn-sm",onClick:e=>B.openModal(!1,l)}," 檢視 ",8,y)])])])])))),128))])]),(0,a.Lk)("div",C,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(T.orders,((l,n)=>((0,a.uX)(),(0,a.CE)("div",{class:"mx-2 my-3 px-2 border rounded-3",key:n},[(0,a.Lk)("div",x,[(0,a.Lk)("div",O,[t[4]||(t[4]=(0,a.Lk)("h6",{class:"mb-0"},"建立日期",-1)),(0,a.Lk)("p",$,(0,s.v_)(e.$filters.date(l.create_at)),1)]),(0,a.Lk)("div",M,[t[5]||(t[5]=(0,a.Lk)("h6",{class:"mb-0"},"訂單編號",-1)),(0,a.Lk)("p",E,(0,s.v_)(l.id),1)]),(0,a.Lk)("div",X,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>B.openDelOrderModal(l)},t[6]||(t[6]=[(0,a.Lk)("i",{class:"bi bi-x-lg"},null,-1)]),8,w)])]),(0,a.Lk)("div",P,[t[7]||(t[7]=(0,a.Lk)("h6",{class:"mb-0"},"商品明細",-1)),(0,a.Lk)("ul",D,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.products,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id}," - "+(0,s.v_)(e.product.title)+" - "+(0,s.v_)(e.qty)+" "+(0,s.v_)(e.product.unit),1)))),128))])]),(0,a.Lk)("div",F,[(0,a.Lk)("div",S,[t[8]||(t[8]=(0,a.Lk)("h6",{class:"mb-0"},"總金額",-1)),(0,a.Lk)("p",I," $"+(0,s.v_)(e.$filters.currency(Math.round(l.total))),1)]),(0,a.Lk)("div",A,[(0,a.Lk)("button",{class:"btn btn-outline-success btn-sm me-3",type:"button",onClick:(0,d.D$)((e=>B.openModal(!1,l)),["prevent"])}," 檢視 ",8,K),(0,a.Lk)("div",U,[(0,a.Lk)("label",{class:"form-check-label",for:`paidSwitch${l.id}`},[l.is_paid?((0,a.uX)(),(0,a.CE)("span",N,"付款完成")):((0,a.uX)(),(0,a.CE)("span",V,"尚未付款"))],8,j),t[9]||(t[9]=(0,a.Lk)("br",null,null,-1)),(0,a.bo)((0,a.Lk)("input",{class:"form-check-input mx-auto",type:"checkbox",id:`paidSwitch${l.id}`,"onUpdate:modelValue":e=>l.is_paid=e,onChange:e=>B.updatePaid(l)},null,40,q),[[d.lH,l.is_paid]])])])])])))),128))]),(0,a.bF)(z,{order:T.tempOrder,ref:"orderModal",onUpdatePaid:B.updatePaid},null,8,["order","onUpdatePaid"]),(0,a.bF)(G,{item:T.tempOrder,ref:"delModal",onDelItem:B.delOrder},null,8,["item","onDelItem"]),(0,a.bF)(J,{pages:T.pagination,onEmitPages:B.getOrders},null,8,["pages","onEmitPages"])])],64)}var T=l(2821);const B={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},Q={class:"modal-dialog modal-lg",role:"document"},z={class:"modal-content border-0"},G={class:"modal-body"},J={class:"row"},R={class:"col-md-5"},W={class:"table"},Y={key:0},Z={key:0},ee={key:1},te={class:"col-md-7"},le={class:"table"},ae={key:0},se={key:1},de={key:0,class:"text-success"},ne={key:1,class:"text-danger"},ie={class:"table"},re={class:"text-end"};function oe(e,t,l,d,n,i){return(0,a.uX)(),(0,a.CE)("div",B,[(0,a.Lk)("div",Q,[(0,a.Lk)("div",z,[t[14]||(t[14]=(0,a.Lk)("div",{class:"modal-header bg-cambridge-blue text-white"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a.Lk)("span",null,"訂單資訊")])],-1)),(0,a.Lk)("div",G,[(0,a.Lk)("div",J,[(0,a.Lk)("div",R,[t[5]||(t[5]=(0,a.Lk)("h4",null,"客戶資料",-1)),(0,a.Lk)("table",W,[n.tempOrder.user?((0,a.uX)(),(0,a.CE)("tbody",Y,[(0,a.Lk)("tr",null,[t[0]||(t[0]=(0,a.Lk)("th",{style:{width:"100px"}},"姓名",-1)),(0,a.Lk)("td",null,(0,s.v_)(n.tempOrder.user.name),1)]),(0,a.Lk)("tr",null,[t[1]||(t[1]=(0,a.Lk)("th",null,"Email",-1)),(0,a.Lk)("td",null,(0,s.v_)(n.tempOrder.user.email),1)]),(0,a.Lk)("tr",null,[t[2]||(t[2]=(0,a.Lk)("th",null,"電話",-1)),(0,a.Lk)("td",null,(0,s.v_)(n.tempOrder.user.tel),1)]),(0,a.Lk)("tr",null,[t[3]||(t[3]=(0,a.Lk)("th",null,"地址",-1)),(0,a.Lk)("td",null,(0,s.v_)(n.tempOrder.user.address),1)]),(0,a.Lk)("tr",null,[t[4]||(t[4]=(0,a.Lk)("th",null,"留言",-1)),n.tempOrder.message?((0,a.uX)(),(0,a.CE)("td",Z,(0,s.v_)(n.tempOrder.message),1)):((0,a.uX)(),(0,a.CE)("td",ee,"無"))])])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",te,[t[12]||(t[12]=(0,a.Lk)("h4",null,"訂單細節",-1)),(0,a.Lk)("table",le,[(0,a.Lk)("tbody",null,[(0,a.Lk)("tr",null,[t[6]||(t[6]=(0,a.Lk)("th",{style:{width:"100px"}},"訂單編號",-1)),(0,a.Lk)("td",null,(0,s.v_)(n.tempOrder.id),1)]),(0,a.Lk)("tr",null,[t[7]||(t[7]=(0,a.Lk)("th",null,"下單時間",-1)),(0,a.Lk)("td",null,(0,s.v_)(new Date(1e3*l.order.create_at).toLocaleString()),1)]),(0,a.Lk)("tr",null,[t[8]||(t[8]=(0,a.Lk)("th",null,"付款時間",-1)),(0,a.Lk)("td",null,[n.tempOrder.paid_date?((0,a.uX)(),(0,a.CE)("span",ae,(0,s.v_)(new Date(1e3*l.order.paid_date).toLocaleString()),1)):((0,a.uX)(),(0,a.CE)("span",se,"-"))])]),(0,a.Lk)("tr",null,[t[9]||(t[9]=(0,a.Lk)("th",null,"付款狀態",-1)),(0,a.Lk)("td",null,[n.tempOrder.is_paid?((0,a.uX)(),(0,a.CE)("strong",de,"付款完成")):((0,a.uX)(),(0,a.CE)("span",ne,"尚未付款"))])]),(0,a.Lk)("tr",null,[t[10]||(t[10]=(0,a.Lk)("th",null,"總金額",-1)),(0,a.Lk)("td",null," $"+(0,s.v_)(e.$filters.currency(Math.round(n.tempOrder.total))),1)])])]),t[13]||(t[13]=(0,a.Lk)("h4",null,"商品明細",-1)),(0,a.Lk)("table",ie,[t[11]||(t[11]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr")],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.tempOrder.products,(t=>((0,a.uX)(),(0,a.CE)("tr",{key:t.id},[(0,a.Lk)("th",null,(0,s.v_)(t.product.title),1),(0,a.Lk)("td",null,(0,s.v_)(t.qty)+" "+(0,s.v_)(t.product.unit),1),(0,a.Lk)("td",re," $"+(0,s.v_)(e.$filters.currency(Math.round(t.final_total))),1)])))),128))])])])])]),t[15]||(t[15]=(0,a.Lk)("div",{class:"modal-footer"},[(0,a.Lk)("button",{type:"button",class:"btnHover","data-bs-dismiss":"modal"},[(0,a.Lk)("div",null,[(0,a.Lk)("span",null,"關閉視窗"),(0,a.Lk)("span",null,"關閉視窗")])])],-1))])])],512)}var ce=l(3308),ue={name:"orderModal",props:{order:{type:Object,default(){return{}}}},data(){return{status:{},modal:"",tempOrder:{},isPaid:!1}},emits:["update-paid"],mixins:[ce.A],inject:["emitter"],watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}}},pe=l(1241);const ke=(0,pe.A)(ue,[["render",oe]]);var he=ke,Le=l(5749),me={data(){return{orders:[],isNew:!1,pagination:{},isLoading:!1,tempOrder:{},currentPage:1}},components:{Pagination:Le.A,DelModal:T.A,OrderModal:he},methods:{getOrders(e=1){this.currentPage=e;const t=`https://vue3-course-api.hexschool.io/api/guantony-api/admin/orders?page=${e}`;this.isLoading=!0,this.$http.get(t,this.tempProduct).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1,this.scrollTop()})).catch((e=>{this.$httpMessageState(e,"連線錯誤")}))},openModal(e,t){this.tempOrder={...t},this.isNew=!1;const l=this.$refs.orderModal;l.showModal()},openDelOrderModal(e){this.tempOrder={...e};const t=this.$refs.delModal;t.showModal()},updatePaid(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/guantony-api/admin/order/${e.id}`,l={is_paid:e.is_paid};this.$http.put(t,{data:l}).then((e=>{this.isLoading=!1,this.$httpMessageState(e,"更新付款狀態"),this.getOrders(this.currentPage),this.$refs.orderModal.hideModal()})).catch((e=>{this.$httpMessageState(e,"連線錯誤")}))},delOrder(){const e=`https://vue3-course-api.hexschool.io/api/guantony-api/admin/order/${this.tempOrder.id}`;this.isLoading=!0,this.$http.delete(e).then((e=>{const t=this.$refs.delModal;t.hideModal(),this.getOrders(this.currentPage)})).catch((e=>{this.$httpMessageState(e,"連線錯誤")}))},scrollTop(){window.scrollTo({top:0,behavior:"smooth"})}},created(){this.getOrders()}};const ge=(0,pe.A)(me,[["render",H]]);var be=ge},5749:function(e,t,l){l.d(t,{A:function(){return k}});var a=l(6768),s=l(4232),d=l(5130);const n={"aria-label":"Page navigation example"},i={class:"pagination justify-content-center",style:{width:"100%"}},r=["onClick"];function o(e,t,l,o,c,u){return(0,a.uX)(),(0,a.CE)("nav",n,[(0,a.Lk)("ul",i,[(0,a.Lk)("li",{class:(0,s.C4)(["page-item hidePrevButton",{disabled:!l.pages.has_pre}])},[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,d.D$)((e=>u.updatePage(l.pages.current_page-1)),["prevent"]))},t[2]||(t[2]=[(0,a.Lk)("span",{"aria-hidden":"true"},"«",-1)]))],2),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.pages.total_pages,(e=>((0,a.uX)(),(0,a.CE)("li",{class:(0,s.C4)(["page-item page_bottom",{active:e===l.pages.current_page}]),key:e},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:(0,d.D$)((t=>u.updatePage(e)),["prevent"])},(0,s.v_)(e),9,r)],2)))),128)),(0,a.Lk)("li",{class:(0,s.C4)(["page-item hideNextButton",{disabled:!l.pages.has_next}])},[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,d.D$)((e=>u.updatePage(l.pages.current_page+1)),["prevent"]))},t[3]||(t[3]=[(0,a.Lk)("span",{"aria-hidden":"true"},"»",-1)]))],2)])])}var c={props:["pages"],methods:{updatePage(e){this.$emit("emit-pages",e)}}},u=l(1241);const p=(0,u.A)(c,[["render",o]]);var k=p}}]);
//# sourceMappingURL=499.dafae2dd.js.map